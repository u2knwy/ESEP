<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1145px" preserveAspectRatio="none" style="width:1039px;height:1145px;background:#FFFFFF;" version="1.1" viewBox="0 0 1039 1145" width="1039px" zoomAndPan="magnify"><defs/><g><!--MD5=[8574b24f32bb9fcb0a100948d7d93e6b]
class IEventHandler--><g id="elem_IEventHandler"><rect codeLine="1" fill="#F1F1F1" height="65.6094" id="IEventHandler" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="59.5" y="7"/><ellipse cx="85.3" cy="23" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M86.2531,19.6406 L86.2531,26.2969 L87.9719,26.2969 Q88.5813,26.2969 88.8469,26.5313 Q89.1125,26.7656 89.1125,27.1563 Q89.1125,27.5313 88.8469,27.7656 Q88.5813,28 87.9719,28 L82.8313,28 Q82.2219,28 81.9563,27.7656 Q81.6906,27.5313 81.6906,27.1406 Q81.6906,26.7656 81.9563,26.5313 Q82.2219,26.2969 82.8313,26.2969 L84.55,26.2969 L84.55,19.6406 L82.8313,19.6406 Q82.2219,19.6406 81.9563,19.4063 Q81.6906,19.1719 81.6906,18.7813 Q81.6906,18.4063 81.9563,18.1719 Q82.2219,17.9375 82.8313,17.9375 L87.9719,17.9375 Q88.5813,17.9375 88.8469,18.1719 Q89.1125,18.4063 89.1125,18.7813 Q89.1125,19.1719 88.8469,19.4063 Q88.5813,19.6406 87.9719,19.6406 L86.2531,19.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="89" x="101.7" y="28.7285">IEventHandler</text><line style="stroke:#181818;stroke-width:0.5;" x1="60.5" x2="203.5" y1="39" y2="39"/><line style="stroke:#181818;stroke-width:0.5;" x1="60.5" x2="203.5" y1="47" y2="47"/><polygon fill="#FFFF44" points="70.5,56.3047,74.5,60.3047,70.5,64.3047,66.5,60.3047" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="79.5" y="65.5332">notify(Event event)</text></g><!--MD5=[537c5cb6be412a5811209c18d6a5b6de]
class WorkpieceType--><g id="elem_WorkpieceType"><rect codeLine="5" fill="#F1F1F1" height="118.4375" id="WorkpieceType" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="901.5" y="399.5"/><ellipse cx="916.5" cy="415.5" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M915.3594,416.2969 L915.3594,418.7969 L919.6875,418.7969 L919.6875,417.875 Q919.6875,417.2656 919.9219,417 Q920.1719,416.7344 920.5469,416.7344 Q920.9219,416.7344 921.1563,417 Q921.3906,417.2656 921.3906,417.875 L921.3906,420.5 L913.3906,420.5 Q912.7656,420.5 912.5,420.2656 Q912.25,420.0313 912.25,419.6406 Q912.25,419.2656 912.5156,419.0313 Q912.7813,418.7969 913.3906,418.7969 L913.6563,418.7969 L913.6563,412.1406 L913.3906,412.1406 Q912.7656,412.1406 912.5,411.9063 Q912.25,411.6719 912.25,411.2813 Q912.25,410.9063 912.5,410.6719 Q912.7656,410.4375 913.3906,410.4375 L921.0156,410.4375 L921.0156,413.0313 Q921.0156,413.6406 920.7813,413.9063 Q920.5625,414.1563 920.1719,414.1563 Q919.7969,414.1563 919.5625,413.9063 Q919.3281,413.6406 919.3281,413.0313 L919.3281,412.1406 L915.3594,412.1406 L915.3594,414.5938 L916.8438,414.5938 Q916.8438,413.9375 916.9688,413.75 Q917.2344,413.3438 917.7031,413.3438 Q918.0781,413.3438 918.3125,413.6094 Q918.5469,413.8594 918.5469,414.4688 L918.5469,416.4375 Q918.5469,416.9844 918.4219,417.1719 Q918.1563,417.5625 917.7031,417.5625 Q917.2344,417.5625 916.9688,417.1563 Q916.8438,416.9688 916.8438,416.2969 L915.3594,416.2969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="930.5" y="421.2285">WorkpieceType</text><line style="stroke:#181818;stroke-width:0.5;" x1="902.5" x2="1031.5" y1="431.5" y2="431.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="907.5" y="450.0332">UNKNOWN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="907.5" y="467.6426">TYPE_A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="907.5" y="485.252">TYPE_B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="907.5" y="502.8613">TYPE_C</text><line style="stroke:#181818;stroke-width:0.5;" x1="902.5" x2="1031.5" y1="509.9375" y2="509.9375"/></g><!--MD5=[7dfcae09b8e0f5046485e9e51db7c66e]
class WorkpieceResult--><g id="elem_WorkpieceResult"><rect codeLine="12" fill="#F1F1F1" height="118.4375" id="WorkpieceResult" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="619.5" y="932.5"/><ellipse cx="634.5" cy="948.5" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M633.3594,949.2969 L633.3594,951.7969 L637.6875,951.7969 L637.6875,950.875 Q637.6875,950.2656 637.9219,950 Q638.1719,949.7344 638.5469,949.7344 Q638.9219,949.7344 639.1563,950 Q639.3906,950.2656 639.3906,950.875 L639.3906,953.5 L631.3906,953.5 Q630.7656,953.5 630.5,953.2656 Q630.25,953.0313 630.25,952.6406 Q630.25,952.2656 630.5156,952.0313 Q630.7813,951.7969 631.3906,951.7969 L631.6563,951.7969 L631.6563,945.1406 L631.3906,945.1406 Q630.7656,945.1406 630.5,944.9063 Q630.25,944.6719 630.25,944.2813 Q630.25,943.9063 630.5,943.6719 Q630.7656,943.4375 631.3906,943.4375 L639.0156,943.4375 L639.0156,946.0313 Q639.0156,946.6406 638.7813,946.9063 Q638.5625,947.1563 638.1719,947.1563 Q637.7969,947.1563 637.5625,946.9063 Q637.3281,946.6406 637.3281,946.0313 L637.3281,945.1406 L633.3594,945.1406 L633.3594,947.5938 L634.8438,947.5938 Q634.8438,946.9375 634.9688,946.75 Q635.2344,946.3438 635.7031,946.3438 Q636.0781,946.3438 636.3125,946.6094 Q636.5469,946.8594 636.5469,947.4688 L636.5469,949.4375 Q636.5469,949.9844 636.4219,950.1719 Q636.1563,950.5625 635.7031,950.5625 Q635.2344,950.5625 634.9688,950.1563 Q634.8438,949.9688 634.8438,949.2969 L633.3594,949.2969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="648.5" y="954.2285">WorkpieceResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="620.5" x2="757.5" y1="964.5" y2="964.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="625.5" y="983.0332">PENDING</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="625.5" y="1000.6426">VALID</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="625.5" y="1018.252">INVALID</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="625.5" y="1035.8613">SORTED_OUT</text><line style="stroke:#181818;stroke-width:0.5;" x1="620.5" x2="757.5" y1="1042.9375" y2="1042.9375"/></g><!--MD5=[a64a835c3d62471a77f615251fdde58a]
class Position--><g id="elem_Position"><rect codeLine="19" fill="#F1F1F1" height="294.5313" id="Position" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="794" y="844"/><ellipse cx="840.75" cy="860" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M839.6094,860.7969 L839.6094,863.2969 L843.9375,863.2969 L843.9375,862.375 Q843.9375,861.7656 844.1719,861.5 Q844.4219,861.2344 844.7969,861.2344 Q845.1719,861.2344 845.4063,861.5 Q845.6406,861.7656 845.6406,862.375 L845.6406,865 L837.6406,865 Q837.0156,865 836.75,864.7656 Q836.5,864.5313 836.5,864.1406 Q836.5,863.7656 836.7656,863.5313 Q837.0313,863.2969 837.6406,863.2969 L837.9063,863.2969 L837.9063,856.6406 L837.6406,856.6406 Q837.0156,856.6406 836.75,856.4063 Q836.5,856.1719 836.5,855.7813 Q836.5,855.4063 836.75,855.1719 Q837.0156,854.9375 837.6406,854.9375 L845.2656,854.9375 L845.2656,857.5313 Q845.2656,858.1406 845.0313,858.4063 Q844.8125,858.6563 844.4219,858.6563 Q844.0469,858.6563 843.8125,858.4063 Q843.5781,858.1406 843.5781,857.5313 L843.5781,856.6406 L839.6094,856.6406 L839.6094,859.0938 L841.0938,859.0938 Q841.0938,858.4375 841.2188,858.25 Q841.4844,857.8438 841.9531,857.8438 Q842.3281,857.8438 842.5625,858.1094 Q842.7969,858.3594 842.7969,858.9688 L842.7969,860.9375 Q842.7969,861.4844 842.6719,861.6719 Q842.4063,862.0625 841.9531,862.0625 Q841.4844,862.0625 841.2188,861.6563 Q841.0938,861.4688 841.0938,860.7969 L839.6094,860.7969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="861.25" y="865.7285">Position</text><line style="stroke:#181818;stroke-width:0.5;" x1="795" x2="945" y1="876" y2="876"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="800" y="894.5332">FBM1_START_HM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="800" y="912.1426">FBM1_HM_MD</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="800" y="929.752">FBM1_MD_SW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="800" y="947.3613">FBM1_SW_RAMP</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="800" y="964.9707">FBM1_SORTED_OUT</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="800" y="982.5801">FBM1_SW_END</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="800" y="1000.1895">FBM1_END</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="800" y="1017.7988">FBM2_START_HM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="800" y="1035.4082">FBM2_HM_MD</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="800" y="1053.0176">FBM2_MD_SW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="800" y="1070.627">FBM2_SW_RAMP</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="800" y="1088.2363">FBM2_SORTED_OUT</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="800" y="1105.8457">FBM2_SW_END</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="800" y="1123.4551">FBM2_END</text><line style="stroke:#181818;stroke-width:0.5;" x1="795" x2="945" y1="1130.5313" y2="1130.5313"/></g><!--MD5=[19076009f2105540ef54892ae477b9e1]
class Workpiece--><g id="elem_Workpiece"><rect codeLine="36" fill="#F1F1F1" height="206.4844" id="Workpiece" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="175" x="691.5" y="355.5"/><ellipse cx="741.25" cy="371.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M744.0156,367.375 Q744.1719,367.1563 744.3594,367.0469 Q744.5469,366.9375 744.7656,366.9375 Q745.1406,366.9375 745.375,367.2031 Q745.6094,367.4531 745.6094,368.0625 L745.6094,369.5156 Q745.6094,370.125 745.375,370.3906 Q745.1406,370.6563 744.7656,370.6563 Q744.4219,370.6563 744.2188,370.4531 Q744.0156,370.2656 743.9063,369.75 Q743.8594,369.3906 743.6719,369.2031 Q743.3438,368.8281 742.7344,368.6094 Q742.125,368.3906 741.5,368.3906 Q740.7344,368.3906 740.0938,368.7188 Q739.4688,369.0469 738.9688,369.7969 Q738.4844,370.5469 738.4844,371.5781 L738.4844,372.6719 Q738.4844,373.9063 739.375,374.7344 Q740.2656,375.5469 741.8594,375.5469 Q742.7969,375.5469 743.4531,375.2969 Q743.8438,375.1406 744.2656,374.7031 Q744.5313,374.4375 744.6719,374.3594 Q744.8281,374.2813 745.0313,374.2813 Q745.3594,374.2813 745.6094,374.5469 Q745.875,374.7969 745.875,375.1406 Q745.875,375.4844 745.5313,375.8906 Q745.0313,376.4688 744.2344,376.7969 Q743.1563,377.25 741.8594,377.25 Q740.3438,377.25 739.1406,376.625 Q738.1563,376.125 737.4688,375.0625 Q736.7813,373.9844 736.7813,372.7031 L736.7813,371.5469 Q736.7813,370.2188 737.3906,369.0781 Q738.0156,367.9219 739.1094,367.3125 Q740.2031,366.6875 741.4375,366.6875 Q742.1719,366.6875 742.8125,366.8594 Q743.4688,367.0156 744.0156,367.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="761.75" y="377.2285">Workpiece</text><line style="stroke:#181818;stroke-width:0.5;" x1="692.5" x2="865.5" y1="387.5" y2="387.5"/><ellipse cx="702.5" cy="401.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="711.5" y="406.0332">int id</text><ellipse cx="702.5" cy="419.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="711.5" y="423.6426">float heightFBM1</text><ellipse cx="702.5" cy="437.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="711.5" y="441.252">bool metalFBM1</text><ellipse cx="702.5" cy="454.6328" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="711.5" y="458.8613">float heightFBM2</text><ellipse cx="702.5" cy="472.2422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="711.5" y="476.4707">bool metalFBM2</text><ellipse cx="702.5" cy="489.8516" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="711.5" y="494.0801">bool flipped</text><ellipse cx="702.5" cy="507.4609" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="711.5" y="511.6895">Position currentPosition</text><ellipse cx="702.5" cy="525.0703" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="711.5" y="529.2988">WorkpieceResult result</text><ellipse cx="702.5" cy="542.6797" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="711.5" y="546.9082">WorkpieceType type</text><line style="stroke:#181818;stroke-width:0.5;" x1="692.5" x2="865.5" y1="553.9844" y2="553.9844"/></g><!--MD5=[5202f3058929cf6811ba564f50d1f312]
class WorkpieceManager--><g id="elem_WorkpieceManager"><rect codeLine="52" fill="#F1F1F1" height="153.6563" id="WorkpieceManager" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="364" x="292" y="381.5"/><ellipse cx="408.25" cy="397.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M411.0156,393.375 Q411.1719,393.1563 411.3594,393.0469 Q411.5469,392.9375 411.7656,392.9375 Q412.1406,392.9375 412.375,393.2031 Q412.6094,393.4531 412.6094,394.0625 L412.6094,395.5156 Q412.6094,396.125 412.375,396.3906 Q412.1406,396.6563 411.7656,396.6563 Q411.4219,396.6563 411.2188,396.4531 Q411.0156,396.2656 410.9063,395.75 Q410.8594,395.3906 410.6719,395.2031 Q410.3438,394.8281 409.7344,394.6094 Q409.125,394.3906 408.5,394.3906 Q407.7344,394.3906 407.0938,394.7188 Q406.4688,395.0469 405.9688,395.7969 Q405.4844,396.5469 405.4844,397.5781 L405.4844,398.6719 Q405.4844,399.9063 406.375,400.7344 Q407.2656,401.5469 408.8594,401.5469 Q409.7969,401.5469 410.4531,401.2969 Q410.8438,401.1406 411.2656,400.7031 Q411.5313,400.4375 411.6719,400.3594 Q411.8281,400.2813 412.0313,400.2813 Q412.3594,400.2813 412.6094,400.5469 Q412.875,400.7969 412.875,401.1406 Q412.875,401.4844 412.5313,401.8906 Q412.0313,402.4688 411.2344,402.7969 Q410.1563,403.25 408.8594,403.25 Q407.3438,403.25 406.1406,402.625 Q405.1563,402.125 404.4688,401.0625 Q403.7813,399.9844 403.7813,398.7031 L403.7813,397.5469 Q403.7813,396.2188 404.3906,395.0781 Q405.0156,393.9219 406.1094,393.3125 Q407.2031,392.6875 408.4375,392.6875 Q409.1719,392.6875 409.8125,392.8594 Q410.4688,393.0156 411.0156,393.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="428.75" y="403.2285">WorkpieceManager</text><line style="stroke:#181818;stroke-width:0.5;" x1="293" x2="655" y1="413.5" y2="413.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="300" y="424.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="203" x="312" y="432.0332">WorkpieceType[3] desiredOrder</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="300" y="442.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="223" x="312" y="449.6426">std::vector&lt;Workpiece&gt; workpieces</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="300" y="460.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="312" y="467.252">int nextID</text><line style="stroke:#181818;stroke-width:0.5;" x1="293" x2="655" y1="474.3281" y2="474.3281"/><ellipse cx="303" cy="488.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="198" x="312" y="492.8613">Workpiece addNewWorkpiece()</text><ellipse cx="303" cy="506.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="311" x="312" y="510.4707">Workpiece getWorkpieceByPosition(Position pos)</text><ellipse cx="303" cy="523.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="338" x="312" y="528.0801">Workpiece updateWorkpiece(Workpiece updatedInfo)</text></g><!--MD5=[06dc4cff1807364324b7ab668f2cc881]
class MainFSM--><g id="elem_MainFSM"><rect codeLine="63" fill="#F1F1F1" height="650.7188" id="MainFSM" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="250" x="7" y="133"/><ellipse cx="98.25" cy="149" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M101.0156,144.875 Q101.1719,144.6563 101.3594,144.5469 Q101.5469,144.4375 101.7656,144.4375 Q102.1406,144.4375 102.375,144.7031 Q102.6094,144.9531 102.6094,145.5625 L102.6094,147.0156 Q102.6094,147.625 102.375,147.8906 Q102.1406,148.1563 101.7656,148.1563 Q101.4219,148.1563 101.2188,147.9531 Q101.0156,147.7656 100.9063,147.25 Q100.8594,146.8906 100.6719,146.7031 Q100.3438,146.3281 99.7344,146.1094 Q99.125,145.8906 98.5,145.8906 Q97.7344,145.8906 97.0938,146.2188 Q96.4688,146.5469 95.9688,147.2969 Q95.4844,148.0469 95.4844,149.0781 L95.4844,150.1719 Q95.4844,151.4063 96.375,152.2344 Q97.2656,153.0469 98.8594,153.0469 Q99.7969,153.0469 100.4531,152.7969 Q100.8438,152.6406 101.2656,152.2031 Q101.5313,151.9375 101.6719,151.8594 Q101.8281,151.7813 102.0313,151.7813 Q102.3594,151.7813 102.6094,152.0469 Q102.875,152.2969 102.875,152.6406 Q102.875,152.9844 102.5313,153.3906 Q102.0313,153.9688 101.2344,154.2969 Q100.1563,154.75 98.8594,154.75 Q97.3438,154.75 96.1406,154.125 Q95.1563,153.625 94.4688,152.5625 Q93.7813,151.4844 93.7813,150.2031 L93.7813,149.0469 Q93.7813,147.7188 94.3906,146.5781 Q95.0156,145.4219 96.1094,144.8125 Q97.2031,144.1875 98.4375,144.1875 Q99.1719,144.1875 99.8125,144.3594 Q100.4688,144.5156 101.0156,144.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="118.75" y="154.7285">MainFSM</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="256" y1="165" y2="165"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="176.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="27" y="183.5332">WorkpieceManager* wpManager</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="193.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="27" y="201.1426">EventManager* eventManager</text><ellipse cx="18" cy="214.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="27" y="218.752">notify(Event event)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="250.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="27" y="257.9707">startPressedShort()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="268.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="27" y="275.5801">startPressedLong()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="285.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="27" y="293.1895">stopPressed()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="303.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="27" y="310.7988">resetPressed()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="321.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="27" y="328.4082">estopPressedFBM1()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="338.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="27" y="346.0176">estopPressedFBM2()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="356.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="27" y="363.627">errorOccured()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="374.0078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="27" y="381.2363">errorSolved()</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="8" x2="52" y1="234.6328" y2="234.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="52" y="239.8613">Handler for button events</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="212" x2="256" y1="234.6328" y2="234.6328"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="413.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="27" y="420.4551">master_lb1Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="430.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="27" y="438.0645">master_lb1Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="448.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="27" y="455.6738">master_lb2Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="466.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="27" y="473.2832">master_lb2Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="483.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="27" y="490.8926">master_lb3Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="501.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="27" y="508.502">master_lb3Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="518.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="27" y="526.1113">master_lb4Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="536.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="27" y="543.7207">master_lb4Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="554.1016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="27" y="561.3301">master_metalDetected()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="571.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="27" y="578.9395">master_newHeightResult(float mm)</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="8" x2="11" y1="397.1172" y2="397.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242" x="11" y="402.3457">Handler for sensor events from master</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="253" x2="256" y1="397.1172" y2="397.1172"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="610.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="27" y="618.1582">slave_lb1Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="628.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="27" y="635.7676">slave_lb1Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="646.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="27" y="653.377">slave_lb2Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="663.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="27" y="670.9863">slave_lb2Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="681.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="27" y="688.5957">slave_lb3Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="698.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="27" y="706.2051">slave_lb3Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="716.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="27" y="723.8145">slave_lb4Blocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="734.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="27" y="741.4238">slave_lb4Unblocked()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="751.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="27" y="759.0332">slave_metalDetected()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="769.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="27" y="776.6426">slave_newHeightResult(float mm)</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="8" x2="16" y1="594.8203" y2="594.8203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232" x="16" y="600.0488">Handler for sensor events from slave</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="248" x2="256" y1="594.8203" y2="594.8203"/></g><!--MD5=[94edf0c28651990ddb14e5c00fbbcfb8]
reverse link Workpiece to Position--><g id="link_Workpiece_Position"><path codeLine="48" d="M798.71,574.5 C812.23,653.43 830.3,758.87 844.87,843.84 " fill="none" id="Workpiece-backto-Position" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="796.49,561.57,793.5629,568.1603,798.5205,573.397,801.4476,566.8067,796.49,561.57" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2c025a8dfd63739b0c192a16aaba496c]
reverse link Workpiece to WorkpieceType--><g id="link_Workpiece_WorkpieceType"><path codeLine="49" d="M879.95,458.5 C887.04,458.5 894.13,458.5 901.22,458.5 " fill="none" id="Workpiece-backto-WorkpieceType" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="866.76,458.5,872.76,462.5,878.76,458.5,872.76,454.5,866.76,458.5" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[623bf10f2a52e9074bd246fe24cac5a6]
reverse link Workpiece to WorkpieceResult--><g id="link_Workpiece_WorkpieceResult"><path codeLine="50" d="M759.52,574.41 C740.84,684.62 713.4,846.56 698.87,932.29 " fill="none" id="Workpiece-backto-WorkpieceResult" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="761.7,561.57,756.7481,566.812,759.6823,573.3992,764.6342,568.1571,761.7,561.57" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e5e603836322f008877b7f6dc0f8e9c7]
reverse link WorkpieceManager to Workpiece--><g id="link_WorkpieceManager_Workpiece"><path codeLine="61" d="M669.41,458.5 C676.7,458.5 683.99,458.5 691.28,458.5 " fill="none" id="WorkpieceManager-backto-Workpiece" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="656.29,458.5,662.29,462.5,668.29,458.5,662.29,454.5,656.29,458.5" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[89546174bc805903e36a5a959b301271]
reverse link IEventHandler to MainFSM--><g id="link_IEventHandler_MainFSM"><path codeLine="100" d="M132,93.35 C132,105.13 132,118.47 132,132.9 " fill="none" id="IEventHandler-backto-MainFSM" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="125,93.34,132,73.34,139,93.34,125,93.34" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8045094768056b40a5d0c7712562eefd]
reverse link MainFSM to WorkpieceManager--><g id="link_MainFSM_WorkpieceManager"><path codeLine="101" d="M270.26,458.5 C277.49,458.5 284.73,458.5 291.96,458.5 " fill="none" id="MainFSM-backto-WorkpieceManager" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="257.24,458.5,263.24,462.5,269.24,458.5,263.24,454.5,257.24,458.5" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[de3b4798c044cefc3927a2757376f188]
@startuml
interface IEventHandler {
  #notify(Event event)
}

enum WorkpieceType {
  UNKNOWN
  TYPE_A
  TYPE_B
  TYPE_C
}

enum WorkpieceResult {
  PENDING
  VALID
  INVALID
  SORTED_OUT
}

enum Position {
  FBM1_START_HM
  FBM1_HM_MD
  FBM1_MD_SW
  FBM1_SW_RAMP
  FBM1_SORTED_OUT
  FBM1_SW_END
  FBM1_END
  FBM2_START_HM
  FBM2_HM_MD
  FBM2_MD_SW
  FBM2_SW_RAMP
  FBM2_SORTED_OUT
  FBM2_SW_END
  FBM2_END
}

class Workpiece {
  +int id
  +float heightFBM1
  +bool metalFBM1
  +float heightFBM2
  +bool metalFBM2
  +bool flipped
  +Position currentPosition
  +WorkpieceResult result
  +WorkpieceType type
}

Workpiece *- - Position
Workpiece *- WorkpieceType
Workpiece *- - WorkpieceResult

class WorkpieceManager {
  -WorkpieceType[3] desiredOrder
  -std::vector<Workpiece> workpieces
  -int nextID
  +Workpiece addNewWorkpiece()
  +Workpiece getWorkpieceByPosition(Position pos)
  +Workpiece updateWorkpiece(Workpiece updatedInfo)
}

WorkpieceManager o- Workpiece

class MainFSM {
  -WorkpieceManager* wpManager
  -EventManager* eventManager
  +notify(Event event)
  .. Handler for button events ..
  -startPressedShort()
  -startPressedLong()
  -stopPressed()
  -resetPressed()
  -estopPressedFBM1()
  -estopPressedFBM2()
  -errorOccured()
  -errorSolved()
  .. Handler for sensor events from master ..
  -master_lb1Blocked()
  -master_lb1Unblocked()
  -master_lb2Blocked()
  -master_lb2Unblocked()
  -master_lb3Blocked()
  -master_lb3Unblocked()
  -master_lb4Blocked()
  -master_lb4Unblocked()
  -master_metalDetected()
  -master_newHeightResult(float mm)
  .. Handler for sensor events from slave ..
  -slave_lb1Blocked()
  -slave_lb1Unblocked()
  -slave_lb2Blocked()
  -slave_lb2Unblocked()
  -slave_lb3Blocked()
  -slave_lb3Unblocked()
  -slave_lb4Blocked()
  -slave_lb4Unblocked()
  -slave_metalDetected()
  -slave_newHeightResult(float mm)
}

IEventHandler <|.. MainFSM
MainFSM o- WorkpieceManager


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>