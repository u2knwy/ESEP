<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2352px" preserveAspectRatio="none" style="width:1547px;height:2352px;background:#FFFFFF;" version="1.1" viewBox="0 0 1547 2352" width="1547px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="89.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="880.3594"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="1428.6875"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="1692.8516"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="2009.7188"/><rect fill="#FFFFFF" height="110.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="255" y="298.0313"/><rect fill="#FFFFFF" height="66.7031" style="stroke:#181818;stroke-width:1.0;" width="10" x="947" y="200.9766"/><rect fill="#FFFFFF" height="169.7578" style="stroke:#181818;stroke-width:1.0;" width="10" x="947" y="475.7891"/><rect fill="#FFFFFF" height="83.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="947" y="736.6016"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1351" y="1324.6328"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="139" x2="139" y1="55.2188" y2="2297.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="259.5" x2="259.5" y1="55.2188" y2="2297.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="468" x2="468" y1="55.2188" y2="2297.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="694" x2="694" y1="55.2188" y2="2297.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="951.5" x2="951.5" y1="55.2188" y2="2297.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1153" x2="1153" y1="55.2188" y2="2297.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1356" x2="1356" y1="55.2188" y2="2297.8828"/><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="102" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="109" y="26.5332">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="126" y="44.1426">HAL</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="102" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="109" y="2318.416">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="126" y="2336.0254">HAL</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="210.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="230" y="26.5332">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="217.5" y="44.1426">HeightSensor</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="210.5" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="230" y="2318.416">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="217.5" y="2336.0254">HeightSensor</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="415" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="438" y="26.5332">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="422" y="44.1426">EventManager</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="415" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="438" y="2318.416">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="422" y="2336.0254">EventManager</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="657" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="664" y="26.5332">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="677" y="44.1426">Logic</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="657" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="664" y="2318.416">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="677" y="2336.0254">Logic</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="883.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="922" y="26.5332">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="890.5" y="44.1426">WorkpieceManager</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="883.5" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="922" y="2318.416">«Master»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="890.5" y="2336.0254">WorkpieceManager</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="1100" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="50" x="1128" y="26.5332">«Slave»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="1107" y="44.1426">EventManager</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="1100" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="50" x="1128" y="2318.416">«Slave»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="1107" y="2336.0254">EventManager</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="1324" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="50" x="1331" y="26.5332">«Slave»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="1343" y="44.1426">HAL</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="1324" y="2296.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="50" x="1331" y="2318.416">«Slave»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="1343" y="2336.0254">HAL</text><rect fill="#FFFFFF" height="89.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="880.3594"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="1428.6875"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="1692.8516"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="2009.7188"/><rect fill="#FFFFFF" height="110.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="255" y="298.0313"/><rect fill="#FFFFFF" height="66.7031" style="stroke:#181818;stroke-width:1.0;" width="10" x="947" y="200.9766"/><rect fill="#FFFFFF" height="169.7578" style="stroke:#181818;stroke-width:1.0;" width="10" x="947" y="475.7891"/><rect fill="#FFFFFF" height="83.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="947" y="736.6016"/><rect fill="#FFFFFF" height="36.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1351" y="1324.6328"/><path d="M22,70.2188 L22,112.2188 L134,112.2188 L134,80.2188 L124,70.2188 L22,70.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M124,70.2188 L124,80.2188 L134,80.2188 L124,70.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="28" y="88.7139">Neues WS an</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="28" y="105.0654">FBM1 eingelegt</text><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="140.2734" y2="136.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="140.2734" y2="144.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="467" y1="140.2734" y2="140.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="146" y="135.417">LB1_1_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="170.625" y2="166.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="170.625" y2="174.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="170.625" y2="170.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="475" y="165.7686">handleEvent(LB1_1_BLOCKED)</text><polygon fill="#181818" points="935,196.9766,945,200.9766,935,204.9766,939,200.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="941" y1="200.9766" y2="200.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="701" y="196.1201">createWp()</text><path d="M962,213.9766 L962,239.9766 L1128,239.9766 L1128,223.9766 L1118,213.9766 L962,213.9766 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1118,213.9766 L1118,223.9766 L1128,223.9766 L1118,213.9766 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="968" y="232.4717">WS mit neuer ID anlegen</text><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="705" y1="267.6797" y2="263.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="705" y1="267.6797" y2="271.6797"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="694" x2="951" y1="267.6797" y2="267.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="711" y="262.8232">createWp(): Workpiece</text><line style="stroke:#181818;stroke-width:1.0;" x1="266" x2="276" y1="298.0313" y2="294.0313"/><line style="stroke:#181818;stroke-width:1.0;" x1="266" x2="276" y1="298.0313" y2="302.0313"/><line style="stroke:#181818;stroke-width:1.0;" x1="265" x2="467" y1="298.0313" y2="298.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="282" y="293.1748">handleEvent(LB1_1_BLOCKED)</text><line style="stroke:#181818;stroke-width:1.0;" x1="265" x2="307" y1="328.3828" y2="328.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="307" y1="328.3828" y2="341.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="266" x2="307" y1="341.3828" y2="341.3828"/><polygon fill="#181818" points="276,337.3828,266,341.3828,276,345.3828,272,341.3828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="272" y="323.5264">start()</text><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="371.7344" y2="367.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="371.7344" y2="375.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="265" x2="467" y1="371.7344" y2="371.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="272" y="366.8779">HM_RESULT_FLAT</text><line style="stroke:#181818;stroke-width:1.0;" x1="265" x2="307" y1="407.0859" y2="407.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="307" y1="407.0859" y2="420.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="260" x2="307" y1="420.0859" y2="420.0859"/><polygon fill="#181818" points="270,416.0859,260,420.0859,270,424.0859,266,420.0859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="272" y="402.2295">stop()</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="445.4375" y2="441.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="445.4375" y2="449.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="445.4375" y2="445.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="475" y="440.5811">handleEvent(HM_RESULT_BOM)</text><polygon fill="#181818" points="935,471.7891,945,475.7891,935,479.7891,939,475.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="941" y1="475.7891" y2="475.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="701" y="470.9326">handleHeightResult(HM_RESULT_BOM)</text><path d="M962,488.7891 L962,530.7891 L1093,530.7891 L1093,498.7891 L1083,488.7891 L962,488.7891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1083,488.7891 L1083,498.7891 L1093,498.7891 L1083,488.7891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="968" y="507.2842">Erstes WS das auf</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="968" y="523.6357">HM wartet updaten</text><line style="stroke:#181818;stroke-width:1.0;" x1="957" x2="999" y1="558.8438" y2="558.8438"/><line style="stroke:#181818;stroke-width:1.0;" x1="999" x2="999" y1="558.8438" y2="571.8438"/><line style="stroke:#181818;stroke-width:1.0;" x1="958" x2="999" y1="571.8438" y2="571.8438"/><polygon fill="#181818" points="968,567.8438,958,571.8438,968,575.8438,964,571.8438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="964" y="553.9873">getWpByPos(START_HM): wp</text><line style="stroke:#181818;stroke-width:1.0;" x1="957" x2="999" y1="618.5469" y2="618.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="999" x2="999" y1="618.5469" y2="631.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="958" x2="999" y1="631.5469" y2="631.5469"/><polygon fill="#181818" points="968,627.5469,958,631.5469,968,635.5469,964,631.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="964" y="597.3389">wp.type = WS_F</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="964" y="613.6904">wp.result = VALID</text><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="705" y1="645.5469" y2="641.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="705" y1="645.5469" y2="649.5469"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="694" x2="951" y1="645.5469" y2="645.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="675.8984" y2="671.8984"/><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="675.8984" y2="679.8984"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="467" y1="675.8984" y2="675.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="146" y="671.042">LB2_1_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="706.25" y2="702.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="706.25" y2="710.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="706.25" y2="706.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="475" y="701.3936">handleEvent(LB2_1_BLOCKED)</text><polygon fill="#181818" points="935,732.6016,945,736.6016,935,740.6016,939,736.6016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="694" x2="941" y1="736.6016" y2="736.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="701" y="731.7451">sortOut()</text><path d="M962,749.6016 L962,791.6016 L1159,791.6016 L1159,759.6016 L1149,749.6016 L962,749.6016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1149,749.6016 L1149,759.6016 L1159,759.6016 L1149,749.6016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="968" y="768.0967">Bestimmen ob WP an Weiche</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="968" y="784.4482">aussortiert werden soll</text><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="705" y1="819.6563" y2="815.6563"/><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="705" y1="819.6563" y2="823.6563"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="694" x2="951" y1="819.6563" y2="819.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="711" y="814.7998">sortOut(): false</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="850.0078" y2="846.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="850.0078" y2="854.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="850.0078" y2="850.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="485" y="845.1514">SORT_1_PASS</text><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="880.3594" y2="876.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="880.3594" y2="884.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="467" y1="880.3594" y2="880.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="161" y="875.5029">handleEvent(SORT_1_PASS)</text><path d="M5,893.3594 L5,935.3594 L129,935.3594 L129,903.3594 L119,893.3594 L5,893.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M119,893.3594 L119,903.3594 L129,903.3594 L119,893.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="11" y="911.8545">Weiche öffnen bis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="11" y="928.2061">WS passiert ist</text><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="186" y1="968.4141" y2="968.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="186" x2="186" y1="968.4141" y2="981.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="186" y1="981.4141" y2="981.4141"/><polygon fill="#181818" points="149,977.4141,139,981.4141,149,985.4141,145,981.4141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="151" y="963.5576">openSwitch()</text><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="1006.7656" y2="1002.7656"/><line style="stroke:#181818;stroke-width:1.0;" x1="466" x2="456" y1="1006.7656" y2="1010.7656"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="467" y1="1006.7656" y2="1006.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="146" y="1001.9092">LB3_1_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1037.1172" y2="1033.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1037.1172" y2="1041.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1037.1172" y2="1037.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="475" y="1032.2607">handleEvent(LB3_1_BLOCKED)</text><path d="M699,1050.1172 L699,1076.1172 L905,1076.1172 L905,1060.1172 L895,1050.1172 L699,1050.1172 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M895,1050.1172 L895,1060.1172 L905,1060.1172 L895,1050.1172 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="705" y="1068.6123">FBM2 ist belegt -&gt; Motor stoppt</text><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="1103.8203" y2="1099.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="1103.8203" y2="1107.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153" x2="1355" y1="1103.8203" y2="1103.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="1170" y="1098.9639">LB3_2_UNBLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1134.1719" y2="1130.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1134.1719" y2="1138.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="1152" y1="1134.1719" y2="1134.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="485" y="1129.3154">LB3_2_UNBLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1164.5234" y2="1160.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1164.5234" y2="1168.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1164.5234" y2="1164.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="475" y="1159.667">handleEvent(LB3_2_UNBLOCKED)</text><path d="M699,1177.5234 L699,1236.5234 L941,1236.5234 L941,1187.5234 L931,1177.5234 L699,1177.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M931,1177.5234 L931,1187.5234 L941,1187.5234 L931,1177.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="705" y="1196.0186">FBM2 ist wieder frei -&gt; State Wechsel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="705" y="1212.3701">(auch möglich wenn WS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="705" y="1228.7217">aussortiert worden wäre)</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1263.9297" y2="1259.9297"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1263.9297" y2="1267.9297"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1263.9297" y2="1263.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="485" y="1259.0732">MOTOR_2_FAST</text><line style="stroke:#181818;stroke-width:1.0;" x1="1151" x2="1141" y1="1294.2813" y2="1290.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="1151" x2="1141" y1="1294.2813" y2="1298.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="1152" y1="1294.2813" y2="1294.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="475" y="1289.4248">MOTOR_2_FAST</text><line style="stroke:#181818;stroke-width:1.0;" x1="1349" x2="1339" y1="1324.6328" y2="1320.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1349" x2="1339" y1="1324.6328" y2="1328.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153" x2="1350" y1="1324.6328" y2="1324.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="1160" y="1319.7764">handleEvent(MOTOR_2_FAST)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1361" x2="1403" y1="1359.9844" y2="1359.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="1403" x2="1403" y1="1359.9844" y2="1372.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="1356" x2="1403" y1="1372.9844" y2="1372.9844"/><polygon fill="#181818" points="1366,1368.9844,1356,1372.9844,1366,1376.9844,1362,1372.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1368" y="1355.1279">motorRightFast()</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1398.3359" y2="1394.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1398.3359" y2="1402.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1398.3359" y2="1398.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="485" y="1393.4795">MOTOR_1_FAST</text><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="1428.6875" y2="1424.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="1428.6875" y2="1432.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="467" y1="1428.6875" y2="1428.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="161" y="1423.8311">handleEvent(MOTOR_1_FAST)</text><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="186" y1="1464.0391" y2="1464.0391"/><line style="stroke:#181818;stroke-width:1.0;" x1="186" x2="186" y1="1464.0391" y2="1477.0391"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="186" y1="1477.0391" y2="1477.0391"/><polygon fill="#181818" points="149,1473.0391,139,1477.0391,149,1481.0391,145,1477.0391" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="151" y="1459.1826">motorRightFast()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="1502.3906" y2="1498.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="1502.3906" y2="1506.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153" x2="1355" y1="1502.3906" y2="1502.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="1170" y="1497.5342">LB1_2_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1532.7422" y2="1528.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1532.7422" y2="1536.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="1152" y1="1532.7422" y2="1532.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="485" y="1527.8857">LB1_2_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1563.0938" y2="1559.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1563.0938" y2="1567.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1563.0938" y2="1563.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="475" y="1558.2373">handleEvent(LB1_2_BLOCKED)</text><path d="M699,1576.0938 L699,1635.0938 L885,1635.0938 L885,1586.0938 L875,1576.0938 L699,1576.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M875,1576.0938 L875,1586.0938 L885,1586.0938 L875,1576.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="705" y="1594.5889">WS an FBM2 angekommen,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="705" y="1610.9404">keine weiteren auf FBM1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="705" y="1627.292">-&gt; Motor kann stoppen</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1662.5" y2="1658.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1662.5" y2="1666.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1662.5" y2="1662.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="485" y="1657.6436">MOTOR_STOP</text><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="1692.8516" y2="1688.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="1692.8516" y2="1696.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="467" y1="1692.8516" y2="1692.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="161" y="1687.9951">handleEvent(MOTOR_STOP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="186" y1="1728.2031" y2="1728.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="186" x2="186" y1="1728.2031" y2="1741.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="186" y1="1741.2031" y2="1741.2031"/><polygon fill="#181818" points="149,1737.2031,139,1741.2031,149,1745.2031,145,1741.2031" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="151" y="1723.3467">motorStop()</text><path d="M1361,1749.2031 L1361,1808.2031 L1540,1808.2031 L1540,1759.2031 L1530,1749.2031 L1361,1749.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1530,1749.2031 L1530,1759.2031 L1540,1759.2031 L1530,1749.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="1367" y="1767.6982">WS läuft bis Ende, gleicher</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="1367" y="1784.0498">Ablauf wie bei FBM1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="1367" y="1800.4014">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="1835.6094" y2="1831.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="1835.6094" y2="1839.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153" x2="1355" y1="1835.6094" y2="1835.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="1170" y="1830.7529">LB3_2_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1865.9609" y2="1861.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1865.9609" y2="1869.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="1152" y1="1865.9609" y2="1865.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="485" y="1861.1045">LB3_2_BLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1896.3125" y2="1892.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="1896.3125" y2="1900.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1896.3125" y2="1896.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="475" y="1891.4561">handleEvent(LB3_2_BLOCKED)</text><path d="M699,1909.3125 L699,1951.3125 L891,1951.3125 L891,1919.3125 L881,1909.3125 L699,1909.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M881,1909.3125 L881,1919.3125 L891,1919.3125 L881,1909.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="705" y="1927.8076">WS ist am Ende von FBM2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="705" y="1944.1592">angekommen -&gt; Motor stoppt</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1979.3672" y2="1975.3672"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="1979.3672" y2="1983.3672"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="1979.3672" y2="1979.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="485" y="1974.5107">MOTOR_STOP</text><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="2009.7188" y2="2005.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="155" y1="2009.7188" y2="2013.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="467" y1="2009.7188" y2="2009.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="161" y="2004.8623">handleEvent(MOTOR_STOP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="186" y1="2045.0703" y2="2045.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="186" x2="186" y1="2045.0703" y2="2058.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="139" x2="186" y1="2058.0703" y2="2058.0703"/><polygon fill="#181818" points="149,2054.0703,139,2058.0703,149,2062.0703,145,2058.0703" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="151" y="2040.2139">motorStop()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="2083.4219" y2="2079.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="2083.4219" y2="2087.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153" x2="1355" y1="2083.4219" y2="2083.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="1170" y="2078.5654">LB3_2_UNBLOCKED</text><path d="M1361,2096.4219 L1361,2138.4219 L1514,2138.4219 L1514,2106.4219 L1504,2096.4219 L1361,2096.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1504,2096.4219 L1504,2106.4219 L1514,2106.4219 L1504,2096.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="1367" y="2114.917">WS wurde entnommen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="1367" y="2131.2686">-&gt; FBM2 ist frei</text><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="2166.4766" y2="2162.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="1154" x2="1164" y1="2166.4766" y2="2170.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153" x2="1355" y1="2166.4766" y2="2166.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="1170" y="2161.6201">LB3_2_UNBLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="2196.8281" y2="2192.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="479" y1="2196.8281" y2="2200.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="1152" y1="2196.8281" y2="2196.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="485" y="2191.9717">LB3_2_UNBLOCKED</text><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="2227.1797" y2="2223.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="692" x2="682" y1="2227.1797" y2="2231.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="468" x2="693" y1="2227.1797" y2="2227.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="475" y="2222.3232">handleEvent(LB3_2_UNBLOCKED)</text><path d="M699,2240.1797 L699,2282.1797 L975,2282.1797 L975,2250.1797 L965,2240.1797 L699,2240.1797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M965,2240.1797 L965,2250.1797 L975,2250.1797 L965,2240.1797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="705" y="2258.6748">State Wechsel -&gt; Nächstes WS kann direkt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="705" y="2275.0264">übergeben werden ohne zu warten...</text><!--MD5=[cdcb2fe2d15697b0238d24e855c3651d]
@startuml
participant "HAL" as HAL_M << Master >>
participant "HeightSensor" as HM_M << Master >>
participant "EventManager" as EVM_M << Master >>
participant "Logic" as Logic << Master >>
participant "WorkpieceManager" as WPM << Master >>
participant "EventManager" as EVM_S << Slave >>
participant "HAL" as HAL_S << Slave >>

note left of HAL_M : Neues WS an\nFBM1 eingelegt
HAL_M ->> EVM_M : LB1_1_BLOCKED
EVM_M ->> Logic : handleEvent(LB1_1_BLOCKED)
Logic -> WPM : createWp()
note right of WPM : WS mit neuer ID anlegen
activate WPM
WPM - ->> Logic : createWp(): Workpiece
deactivate WPM
EVM_M ->> HM_M : handleEvent(LB1_1_BLOCKED)
activate HM_M
HM_M -> HM_M : start()
HM_M ->> EVM_M : HM_RESULT_FLAT
HM_M -> HM_M : stop()
deactivate HM_M
EVM_M ->> Logic : handleEvent(HM_RESULT_BOM)
Logic -> WPM : handleHeightResult(HM_RESULT_BOM)
activate WPM
note right of WPM : Erstes WS das auf\nHM wartet updaten
WPM -> WPM : getWpByPos(START_HM): wp
WPM -> WPM : wp.type = WS_F\nwp.result = VALID
WPM - ->> Logic
deactivate WPM

HAL_M ->> EVM_M : LB2_1_BLOCKED
EVM_M ->> Logic : handleEvent(LB2_1_BLOCKED)
Logic -> WPM : sortOut()
activate WPM
note right of WPM : Bestimmen ob WP an Weiche\naussortiert werden soll
WPM - ->> Logic : sortOut(): false
deactivate WPM
Logic ->> EVM_M : SORT_1_PASS
EVM_M ->> HAL_M : handleEvent(SORT_1_PASS)
note left of HAL_M : Weiche öffnen bis\nWS passiert ist
activate HAL_M
HAL_M -> HAL_M : openSwitch()
deactivate HAL_M
HAL_M ->> EVM_M : LB3_1_BLOCKED
EVM_M ->> Logic : handleEvent(LB3_1_BLOCKED)
note right of Logic : FBM2 ist belegt -> Motor stoppt
HAL_S ->> EVM_S : LB3_2_UNBLOCKED
EVM_S ->> EVM_M : LB3_2_UNBLOCKED
EVM_M ->> Logic : handleEvent(LB3_2_UNBLOCKED)
note right of Logic : FBM2 ist wieder frei -> State Wechsel\n(auch möglich wenn WS\naussortiert worden wäre)
Logic ->> EVM_M : MOTOR_2_FAST
EVM_M ->> EVM_S : MOTOR_2_FAST
EVM_S ->> HAL_S : handleEvent(MOTOR_2_FAST)
activate HAL_S
HAL_S -> HAL_S : motorRightFast()
deactivate HAL_S
Logic ->> EVM_M : MOTOR_1_FAST
EVM_M ->> HAL_M : handleEvent(MOTOR_1_FAST)
activate HAL_M
HAL_M -> HAL_M : motorRightFast()
deactivate HAL_M

' WS an FBM2 angekommen -> 
HAL_S ->> EVM_S : LB1_2_BLOCKED
EVM_S ->> EVM_M : LB1_2_BLOCKED
EVM_M ->> Logic : handleEvent(LB1_2_BLOCKED)
note right of Logic : WS an FBM2 angekommen,\nkeine weiteren auf FBM1\n-> Motor kann stoppen
Logic ->> EVM_M : MOTOR_STOP
EVM_M ->> HAL_M : handleEvent(MOTOR_STOP)
activate HAL_M
HAL_M -> HAL_M : motorStop()
deactivate HAL_M

note right of HAL_S : WS läuft bis Ende, gleicher\nAblauf wie bei FBM1\n...
HAL_S ->> EVM_S : LB3_2_BLOCKED
EVM_S ->> EVM_M : LB3_2_BLOCKED
EVM_M ->> Logic : handleEvent(LB3_2_BLOCKED)
note right of Logic : WS ist am Ende von FBM2\nangekommen -> Motor stoppt
Logic ->> EVM_M : MOTOR_STOP
EVM_M ->> HAL_M : handleEvent(MOTOR_STOP)
activate HAL_M
HAL_M -> HAL_M : motorStop()
deactivate HAL_M

HAL_S ->> EVM_S : LB3_2_UNBLOCKED
note right of HAL_S : WS wurde entnommen\n-> FBM2 ist frei
HAL_S ->> EVM_S : LB3_2_UNBLOCKED
EVM_S ->> EVM_M : LB3_2_UNBLOCKED
EVM_M ->> Logic : handleEvent(LB3_2_UNBLOCKED)
note right of Logic : State Wechsel -> Nächstes WS kann direkt\nübergeben werden ohne zu warten...

@enduml

@startuml
participant "HAL" as HAL_M << Master >>
participant "HeightSensor" as HM_M << Master >>
participant "EventManager" as EVM_M << Master >>
participant "Logic" as Logic << Master >>
participant "WorkpieceManager" as WPM << Master >>
participant "EventManager" as EVM_S << Slave >>
participant "HAL" as HAL_S << Slave >>

note left of HAL_M : Neues WS an\nFBM1 eingelegt
HAL_M ->> EVM_M : LB1_1_BLOCKED
EVM_M ->> Logic : handleEvent(LB1_1_BLOCKED)
Logic -> WPM : createWp()
note right of WPM : WS mit neuer ID anlegen
activate WPM
WPM - ->> Logic : createWp(): Workpiece
deactivate WPM
EVM_M ->> HM_M : handleEvent(LB1_1_BLOCKED)
activate HM_M
HM_M -> HM_M : start()
HM_M ->> EVM_M : HM_RESULT_FLAT
HM_M -> HM_M : stop()
deactivate HM_M
EVM_M ->> Logic : handleEvent(HM_RESULT_BOM)
Logic -> WPM : handleHeightResult(HM_RESULT_BOM)
activate WPM
note right of WPM : Erstes WS das auf\nHM wartet updaten
WPM -> WPM : getWpByPos(START_HM): wp
WPM -> WPM : wp.type = WS_F\nwp.result = VALID
WPM - ->> Logic
deactivate WPM

HAL_M ->> EVM_M : LB2_1_BLOCKED
EVM_M ->> Logic : handleEvent(LB2_1_BLOCKED)
Logic -> WPM : sortOut()
activate WPM
note right of WPM : Bestimmen ob WP an Weiche\naussortiert werden soll
WPM - ->> Logic : sortOut(): false
deactivate WPM
Logic ->> EVM_M : SORT_1_PASS
EVM_M ->> HAL_M : handleEvent(SORT_1_PASS)
note left of HAL_M : Weiche öffnen bis\nWS passiert ist
activate HAL_M
HAL_M -> HAL_M : openSwitch()
deactivate HAL_M
HAL_M ->> EVM_M : LB3_1_BLOCKED
EVM_M ->> Logic : handleEvent(LB3_1_BLOCKED)
note right of Logic : FBM2 ist belegt -> Motor stoppt
HAL_S ->> EVM_S : LB3_2_UNBLOCKED
EVM_S ->> EVM_M : LB3_2_UNBLOCKED
EVM_M ->> Logic : handleEvent(LB3_2_UNBLOCKED)
note right of Logic : FBM2 ist wieder frei -> State Wechsel\n(auch möglich wenn WS\naussortiert worden wäre)
Logic ->> EVM_M : MOTOR_2_FAST
EVM_M ->> EVM_S : MOTOR_2_FAST
EVM_S ->> HAL_S : handleEvent(MOTOR_2_FAST)
activate HAL_S
HAL_S -> HAL_S : motorRightFast()
deactivate HAL_S
Logic ->> EVM_M : MOTOR_1_FAST
EVM_M ->> HAL_M : handleEvent(MOTOR_1_FAST)
activate HAL_M
HAL_M -> HAL_M : motorRightFast()
deactivate HAL_M

HAL_S ->> EVM_S : LB1_2_BLOCKED
EVM_S ->> EVM_M : LB1_2_BLOCKED
EVM_M ->> Logic : handleEvent(LB1_2_BLOCKED)
note right of Logic : WS an FBM2 angekommen,\nkeine weiteren auf FBM1\n-> Motor kann stoppen
Logic ->> EVM_M : MOTOR_STOP
EVM_M ->> HAL_M : handleEvent(MOTOR_STOP)
activate HAL_M
HAL_M -> HAL_M : motorStop()
deactivate HAL_M

note right of HAL_S : WS läuft bis Ende, gleicher\nAblauf wie bei FBM1\n...
HAL_S ->> EVM_S : LB3_2_BLOCKED
EVM_S ->> EVM_M : LB3_2_BLOCKED
EVM_M ->> Logic : handleEvent(LB3_2_BLOCKED)
note right of Logic : WS ist am Ende von FBM2\nangekommen -> Motor stoppt
Logic ->> EVM_M : MOTOR_STOP
EVM_M ->> HAL_M : handleEvent(MOTOR_STOP)
activate HAL_M
HAL_M -> HAL_M : motorStop()
deactivate HAL_M

HAL_S ->> EVM_S : LB3_2_UNBLOCKED
note right of HAL_S : WS wurde entnommen\n-> FBM2 ist frei
HAL_S ->> EVM_S : LB3_2_UNBLOCKED
EVM_S ->> EVM_M : LB3_2_UNBLOCKED
EVM_M ->> Logic : handleEvent(LB3_2_UNBLOCKED)
note right of Logic : State Wechsel -> Nächstes WS kann direkt\nübergeben werden ohne zu warten...

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>